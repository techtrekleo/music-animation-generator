# 音樂動畫生成器 - 使用指南

## 🎯 專案概述

這是一個能夠根據上傳的音樂自動生成動畫影片的系統，類似於YouTube Shorts中的音樂視覺化效果。系統會分析音樂的頻譜、節拍和強度，並生成相應的動態視覺效果。

## 🚀 快速開始

### 1. 安裝依賴
```bash
npm install
```

### 2. 啟動開發伺服器
```bash
npm run dev
# 或使用啟動腳本
./start.sh
```

### 3. 開啟瀏覽器
訪問 `http://localhost:3000`

## 🎵 功能特色

### 音頻分析
- **實時頻譜分析**: 分析音樂的低音、中音、高音頻率
- **節拍檢測**: 自動檢測音樂節拍並觸發視覺效果
- **音量監控**: 根據音量強度調整動畫強度

### 視覺效果
- **波浪效果**: 根據低音頻率生成流動的波浪動畫
- **粒子效果**: 高音頻率觸發的粒子爆炸效果
- **幾何效果**: 中音頻率控制的幾何圖形變換
- **流體效果**: 模擬流體動態的視覺效果
- **神經網絡**: 創建神經網絡般的連接動畫

### 影片導出
- **實時錄製**: 邊播放邊錄製動畫
- **高品質輸出**: 支援 1080p 60fps 輸出
- **多格式支援**: 導出 WebM 格式影片

## 🎨 使用步驟

### 1. 上傳音樂檔案
- 支援格式: MP3, WAV, OGG, M4A
- 拖拽檔案到上傳區域或點擊選擇檔案
- 系統會自動分析音樂檔案

### 2. 選擇視覺效果
- 從預設效果中選擇喜歡的動畫類型
- 調整每個效果的參數:
  - **強度**: 控制效果對音頻的敏感度
  - **速度**: 調整動畫播放速度
  - **大小**: 控制效果元素的尺寸
  - **顏色**: 自定義效果顏色

### 3. 自定義背景
- 選擇背景顏色
- 支援任何十六進制顏色代碼

### 4. 播放預覽
- 點擊播放按鈕開始播放音樂
- 即時預覽動畫效果
- 調整音量大小

### 5. 錄製影片
- 點擊錄製按鈕開始錄製
- 系統會生成與音樂同步的動畫影片
- 自動下載到本地

## 🛠️ 技術架構

### 前端技術
- **React 18**: 現代化 UI 框架
- **TypeScript**: 類型安全的 JavaScript
- **Tailwind CSS**: 實用優先的 CSS 框架

### 音頻處理
- **Web Audio API**: 瀏覽器原生音頻處理
- **AnalyserNode**: 頻譜分析
- **AudioContext**: 音頻上下文管理

### 動畫引擎
- **Three.js**: 3D 圖形庫
- **GSAP**: 高性能動畫庫
- **Canvas API**: 2D 圖形渲染

### 影片導出
- **MediaRecorder API**: 瀏覽器原生錄製
- **Canvas Stream**: 畫布流媒體

## 📁 專案結構

```
music-animation-generator/
├── src/
│   ├── components/          # React 組件
│   │   ├── FileUpload.tsx   # 檔案上傳組件
│   │   ├── AnimationCanvas.tsx # 動畫畫布組件
│   │   ├── ControlPanel.tsx # 控制面板組件
│   │   └── EffectSelector.tsx # 效果選擇器組件
│   ├── audio/               # 音頻處理模組
│   │   └── AudioAnalyzer.ts # 音頻分析器
│   ├── animation/           # 動畫引擎
│   │   └── AnimationEngine.ts # 動畫引擎
│   ├── hooks/               # React Hooks
│   │   ├── useAudioAnalyzer.ts # 音頻分析 Hook
│   │   └── useAnimationEngine.ts # 動畫引擎 Hook
│   ├── utils/               # 工具函數
│   │   └── VideoExporter.ts # 影片導出工具
│   ├── types/               # TypeScript 類型定義
│   │   └── index.ts         # 類型定義
│   ├── App.tsx              # 主應用組件
│   ├── main.tsx             # 應用入口
│   └── index.css            # 全域樣式
├── public/                  # 靜態資源
├── package.json             # 專案配置
├── vite.config.ts           # Vite 配置
├── tailwind.config.js       # Tailwind 配置
├── start.sh                 # 啟動腳本
└── README.md                # 專案說明
```

## 🎯 動畫效果詳解

### 波浪效果 (Wave Effect)
- **觸發**: 低音頻率 (0-10% 頻譜)
- **視覺**: 流動的波浪動畫
- **參數**: 強度影響波浪高度，速度影響流動快慢

### 粒子效果 (Particle Effect)
- **觸發**: 音量強度和節拍
- **視覺**: 彩色粒子爆炸和移動
- **參數**: 大小控制粒子數量，顏色可自定義

### 幾何效果 (Geometric Effect)
- **觸發**: 高音頻率 (50-100% 頻譜)
- **視覺**: 幾何圖形旋轉和縮放
- **參數**: 節拍觸發縮放動畫

### 流體效果 (Fluid Effect)
- **觸發**: 中音頻率 (10-50% 頻譜)
- **視覺**: 流體般的變形動畫
- **參數**: 使用 Shader 實現複雜變形

### 神經網絡 (Neural Effect)
- **觸發**: 低音和高音組合
- **視覺**: 節點連接的網絡動畫
- **參數**: 模擬神經網絡的動態連接

## 🔧 自定義開發

### 添加新效果
1. 在 `AnimationEngine.ts` 中添加新的效果類型
2. 實現 `createXXXEffect` 和 `updateXXXEffect` 方法
3. 在 `EffectSelector.tsx` 中添加預設配置
4. 更新 `types/index.ts` 中的類型定義

### 調整音頻分析
1. 修改 `AudioAnalyzer.ts` 中的頻譜分析算法
2. 調整頻率帶劃分 (bass, mid, treble)
3. 改進節拍檢測算法

### 優化性能
1. 調整 Three.js 渲染參數
2. 優化動畫更新頻率
3. 實現對象池模式重用幾何體

## 🐛 常見問題

### Q: 為什麼某些音樂檔案無法載入？
A: 請確保檔案格式為 MP3、WAV、OGG 或 M4A，且檔案大小不超過 100MB。

### Q: 動畫效果不明顯怎麼辦？
A: 嘗試調整效果的強度參數，或選擇更敏感的顏色搭配。

### Q: 錄製的影片品質如何？
A: 系統預設輸出 1080p 60fps 的 WebM 格式影片，品質較高但檔案較大。

### Q: 如何提高動畫流暢度？
A: 關閉其他應用程式釋放系統資源，或降低瀏覽器其他分頁的負載。

## 📝 更新日誌

### v1.0.0 (2024-01-XX)
- ✨ 初始版本發布
- 🎵 支援多種音頻格式
- 🎨 5種視覺效果
- 🎬 影片導出功能
- 📱 響應式設計

## 🤝 貢獻指南

歡迎提交 Issue 和 Pull Request 來改進這個專案！

## 📄 授權

MIT License - 詳見 LICENSE 檔案
